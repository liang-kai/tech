<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>从输入URL到页面展示发生了什么 | 前端记录</title>
    <meta name="description" content="欢迎来到我的博客">
    
    
    <link rel="preload" href="/tech/assets/css/0.styles.4930e496.css" as="style"><link rel="preload" href="/tech/assets/js/app.58c83021.js" as="script"><link rel="preload" href="/tech/assets/js/2.1d376163.js" as="script"><link rel="preload" href="/tech/assets/js/17.7d59efb2.js" as="script"><link rel="prefetch" href="/tech/assets/js/10.ec0d9ee9.js"><link rel="prefetch" href="/tech/assets/js/11.1260a52a.js"><link rel="prefetch" href="/tech/assets/js/12.39b0201e.js"><link rel="prefetch" href="/tech/assets/js/13.5e88857f.js"><link rel="prefetch" href="/tech/assets/js/14.f25e2b96.js"><link rel="prefetch" href="/tech/assets/js/15.4852bc44.js"><link rel="prefetch" href="/tech/assets/js/16.ec089411.js"><link rel="prefetch" href="/tech/assets/js/18.3af23708.js"><link rel="prefetch" href="/tech/assets/js/19.2494c51c.js"><link rel="prefetch" href="/tech/assets/js/20.60b19e68.js"><link rel="prefetch" href="/tech/assets/js/21.4f5d59a4.js"><link rel="prefetch" href="/tech/assets/js/22.1e0e92f6.js"><link rel="prefetch" href="/tech/assets/js/23.f41d6e8a.js"><link rel="prefetch" href="/tech/assets/js/24.525a86c2.js"><link rel="prefetch" href="/tech/assets/js/25.1c150141.js"><link rel="prefetch" href="/tech/assets/js/26.a3196afd.js"><link rel="prefetch" href="/tech/assets/js/27.d7d1de0e.js"><link rel="prefetch" href="/tech/assets/js/28.33a98d66.js"><link rel="prefetch" href="/tech/assets/js/29.3919e93e.js"><link rel="prefetch" href="/tech/assets/js/3.37e0feac.js"><link rel="prefetch" href="/tech/assets/js/30.8332afa5.js"><link rel="prefetch" href="/tech/assets/js/31.b2bf3b00.js"><link rel="prefetch" href="/tech/assets/js/32.d44a7590.js"><link rel="prefetch" href="/tech/assets/js/33.70b05627.js"><link rel="prefetch" href="/tech/assets/js/4.4b7d39e7.js"><link rel="prefetch" href="/tech/assets/js/5.775f8087.js"><link rel="prefetch" href="/tech/assets/js/6.d2c5430e.js"><link rel="prefetch" href="/tech/assets/js/7.ec8d9b42.js"><link rel="prefetch" href="/tech/assets/js/8.320b11f5.js"><link rel="prefetch" href="/tech/assets/js/9.e3e975cc.js">
    <link rel="stylesheet" href="/tech/assets/css/0.styles.4930e496.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/tech/" class="home-link router-link-active"><!----> <span class="site-name">前端记录</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/tech/blog/" class="nav-link router-link-active">Blog</a></div><div class="nav-item"><a href="/tech/js语言特性/" class="nav-link">语言特性</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/tech/blog/" class="nav-link router-link-active">Blog</a></div><div class="nav-item"><a href="/tech/js语言特性/" class="nav-link">语言特性</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>浏览器的工作原理和实践</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tech/blog/宏观视角下的浏览器.html" class="active sidebar-link">从输入URL到页面展示发生了什么</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tech/blog/宏观视角下的浏览器.html#浏览器的进程" class="sidebar-link">浏览器的进程</a></li><li class="sidebar-sub-header"><a href="/tech/blog/宏观视角下的浏览器.html#http-和-tcp介绍" class="sidebar-link">HTTP 和 TCP介绍</a></li><li class="sidebar-sub-header"><a href="/tech/blog/宏观视角下的浏览器.html#开始请求" class="sidebar-link">开始请求</a></li></ul></li><li><a href="/tech/blog/浏览器中的javascript执行机制.html" class="sidebar-link">浏览器中的javasxript执行机制</a></li><li><a href="/tech/blog/v8工作原理.html" class="sidebar-link">V8 工作原理</a></li><li><a href="/tech/blog/浏览器中的页面循环系统.html" class="sidebar-link">浏览器中的页面循环系统</a></li><li><a href="/tech/blog/浏览器的页面.html" class="sidebar-link">浏览器中的页面</a></li><li><a href="/tech/blog/浏览器中的网络.html" class="sidebar-link">网络</a></li><li><a href="/tech/blog/浏览器安全.html" class="sidebar-link">浏览器安全</a></li></ul></section></li><li><a href="/tech/blog/c.html" class="sidebar-link">React</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="从输入url到页面展示发生了什么"><a href="#从输入url到页面展示发生了什么" aria-hidden="true" class="header-anchor">#</a> 从输入URL到页面展示发生了什么</h1> <h2 id="浏览器的进程"><a href="#浏览器的进程" aria-hidden="true" class="header-anchor">#</a> 浏览器的进程</h2> <p>当前大多浏览器都是基于google开源的Chromium二次开发的，Chrome作为google的官方浏览器，特性和Chrominum基本一致。用Chrome来说下浏览器的进程。</p> <p>先区分下进程和线程，进程是程序的运行实例，操作系统会分配一块独立的内存空间存放代码、数据来作为运行环境。进程间通信通过IPC机制。线程是进程开辟的计算单元，同一进程的不同线程可以共享运行时代码、数据。</p> <p>Chrome基础共享进程有三个：</p> <ol><li>浏览器进程：负责用户交互、子进程管理、文件存储等</li> <li>网络进程：提供网络通信功能</li> <li>GPU进程：绘制图层</li></ol> <p>还有两个不定数量的进程：</p> <ol><li>渲染进程： 每个同源页面会分配一个进程，解析html\css\js,排版引擎Blink和js引擎V8都是在这个进程里。</li> <li>插件进程：之所以把插件独立出来，是为了避免插件问题引起的崩溃问题。</li></ol> <h2 id="http-和-tcp介绍"><a href="#http-和-tcp介绍" aria-hidden="true" class="header-anchor">#</a> HTTP 和 TCP介绍</h2> <p>HTTP是应用层协议，TCP是传输层协议。</p> <p>一个数据包加上IP和端口号，在两个机器的应用之间通过网络进行传送，这样的协议我们叫<code>UDP</code>。一个数据包最多14k,数据多那就需要进行拆分、发送、组装才能正确地通信，UDP满足不了，所有有个TCP。确保数据通过复杂的网络也能被正确的接收到，实现了丢包重传、以及数据序列机制。</p> <p>TCP分三个阶段：</p> <ol><li>建立连接。</li> <li>传输数据。</li> <li>断开连接。
TODO：待完善</li></ol> <p>HTTP是TCP协议之上，也就是HTTP的内容会被TCP协议包裹了发出去。
可分为请求行、请求头、请求体。</p> <p>请求行又包括：</p> <ol><li>请求方法
<ul><li><code>get</code> 获取</li> <li><code>post</code> 创建或修改</li> <li><code>delete</code> 删除</li> <li><code>put</code> 整体更新</li> <li><code>patch</code> 部分更新</li> <li><code>head</code> 只需要相应头</li></ul></li> <li>请求地址</li> <li>请求协议</li></ol> <p>请求头代表当前环境信息，也就是浏览器信息，部分包括：</p> <p><code>user-agent</code>: 浏览器信息（版本、厂商、内核等）
<code>accept-lauguage</code>: 语言
<code>accept</code>: 期望接收格式
<code>accept-encoding</code>: 期望压缩格式
<code>referer</code>: 当前请求页面来源
<code>host</code>: 当前页面host
<code>cookie</code>: 可以在客户端和服务端来回通信的、可持久存储的数据,一个重要的作用是用来标识用户
<code>connection</code>: 是否持久链接，if yes,下次tcp链接建立就免了</p> <p>响应头是服务端的应答，部分包括：</p> <p><code>content-encoding</code>: 编码格式
<code>content-length</code>: 数据大小
<code>content-type</code>: 数据格式
<code>date</code>: 时间
<code>last-modified</code>: 最后一次修改时间
<code>location</code>: 状态为转移的时候标明转移地址
<code>set-cookie</code>: 设置cookie</p> <h2 id="开始请求"><a href="#开始请求" aria-hidden="true" class="header-anchor">#</a> 开始请求</h2> <p>从导航栏输入地址或内容（内容会被浏览器转为地址），到页面呈现是个漫长的说明过程，咱们慢慢来。</p> <p>导航栏有了地址，譬如<a href="http://baidu.com" target="_blank" rel="noopener noreferrer">http://baidu.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，按下回车，这时浏览器就哗啦啦滴卖力工作了。</p> <ol><li>浏览器进程处理用户输入，交给网络进程发起http请求</li> <li>网络进程：
<ol><li>DNS查询ip</li> <li>准备TCP链接，如果同一域名的tcp超出限额（6），等待</li> <li>发起http请求，接收相应头之后通知浏览器进程</li></ol></li> <li>浏览器进程准备渲染进程
<ol><li>网络进程把响应体数据给了渲染进程</li> <li>渲染进程通知浏览器进程确认提交了文档，浏览器进程进行页面状态栏变更</li></ol></li> <li>渲染进程解析文档、请求子资源、绘制（1-5在主线程执行，之后是合成线程，重排、重绘都会影响主线程，而translate属性直接在合成线程操作，不影响主线程，显得流畅）
<ol><li><code>构建DOM树</code>  html ==&gt; DOM 树构建</li> <li><code>计算样式</code>   层叠样式表的计算，标准化处理</li> <li><code>构建布局树</code> DOM 和 样式 构建成书，只展示需要的，display:none 的就算了</li> <li><code>分层</code>   和PS一样，需要分图层的，有层叠上下文属性的元素（display:fixed; opacity: .5; filter:blue(1px); z-index:2）\ 有overflow内容溢出展示的 都会单独拉出一层，除此之外的元素在一个主图层。</li> <li><code>绘制列表</code>   图层分好了，接下来绘制，会生成绘制列表（描述文件）</li> <li><code>分块、栅格化</code>   视窗比页面一般小很多，保证视窗的优先加载对体验很重要。按照某个尺寸（256x256或512x512）把图层分块，生成位图（这里要交给GPU进程来做）</li> <li><code>展示</code>   渲染进程传给浏览器进程消息，展示在屏幕上</li></ol></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/tech/blog/浏览器中的javascript执行机制.html">浏览器中的javasxript执行机制</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/tech/assets/js/app.58c83021.js" defer></script><script src="/tech/assets/js/2.1d376163.js" defer></script><script src="/tech/assets/js/17.7d59efb2.js" defer></script>
  </body>
</html>
