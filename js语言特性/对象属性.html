<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>javascript 对象属性的操作 | 前端记录</title>
    <meta name="description" content="欢迎来到我的博客">
    
    
    <link rel="preload" href="/tech/assets/css/0.styles.4930e496.css" as="style"><link rel="preload" href="/tech/assets/js/app.58c83021.js" as="script"><link rel="preload" href="/tech/assets/js/2.1d376163.js" as="script"><link rel="preload" href="/tech/assets/js/30.8332afa5.js" as="script"><link rel="prefetch" href="/tech/assets/js/10.ec0d9ee9.js"><link rel="prefetch" href="/tech/assets/js/11.1260a52a.js"><link rel="prefetch" href="/tech/assets/js/12.39b0201e.js"><link rel="prefetch" href="/tech/assets/js/13.5e88857f.js"><link rel="prefetch" href="/tech/assets/js/14.f25e2b96.js"><link rel="prefetch" href="/tech/assets/js/15.4852bc44.js"><link rel="prefetch" href="/tech/assets/js/16.ec089411.js"><link rel="prefetch" href="/tech/assets/js/17.7d59efb2.js"><link rel="prefetch" href="/tech/assets/js/18.3af23708.js"><link rel="prefetch" href="/tech/assets/js/19.2494c51c.js"><link rel="prefetch" href="/tech/assets/js/20.60b19e68.js"><link rel="prefetch" href="/tech/assets/js/21.4f5d59a4.js"><link rel="prefetch" href="/tech/assets/js/22.1e0e92f6.js"><link rel="prefetch" href="/tech/assets/js/23.f41d6e8a.js"><link rel="prefetch" href="/tech/assets/js/24.525a86c2.js"><link rel="prefetch" href="/tech/assets/js/25.1c150141.js"><link rel="prefetch" href="/tech/assets/js/26.a3196afd.js"><link rel="prefetch" href="/tech/assets/js/27.d7d1de0e.js"><link rel="prefetch" href="/tech/assets/js/28.33a98d66.js"><link rel="prefetch" href="/tech/assets/js/29.3919e93e.js"><link rel="prefetch" href="/tech/assets/js/3.37e0feac.js"><link rel="prefetch" href="/tech/assets/js/31.b2bf3b00.js"><link rel="prefetch" href="/tech/assets/js/32.d44a7590.js"><link rel="prefetch" href="/tech/assets/js/33.70b05627.js"><link rel="prefetch" href="/tech/assets/js/4.4b7d39e7.js"><link rel="prefetch" href="/tech/assets/js/5.775f8087.js"><link rel="prefetch" href="/tech/assets/js/6.d2c5430e.js"><link rel="prefetch" href="/tech/assets/js/7.ec8d9b42.js"><link rel="prefetch" href="/tech/assets/js/8.320b11f5.js"><link rel="prefetch" href="/tech/assets/js/9.e3e975cc.js">
    <link rel="stylesheet" href="/tech/assets/css/0.styles.4930e496.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/tech/" class="home-link router-link-active"><!----> <span class="site-name">前端记录</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/tech/blog/" class="nav-link">Blog</a></div><div class="nav-item"><a href="/tech/js语言特性/" class="nav-link">语言特性</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/tech/blog/" class="nav-link">Blog</a></div><div class="nav-item"><a href="/tech/js语言特性/" class="nav-link">语言特性</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/tech/js语言特性/对象属性.html" class="active sidebar-link">javascript 对象属性的操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tech/js语言特性/对象属性.html#属性类型" class="sidebar-link">属性类型</a></li><li class="sidebar-sub-header"><a href="/tech/js语言特性/对象属性.html#定义属性-读取属性" class="sidebar-link">定义属性&amp;读取属性</a></li><li class="sidebar-sub-header"><a href="/tech/js语言特性/对象属性.html#proxy" class="sidebar-link">Proxy</a></li></ul></li><li><a href="/tech/js语言特性/基本数据类型.html" class="sidebar-link">JS 的语法和数据类型</a></li><li><a href="/tech/js语言特性/对象继承.html" class="sidebar-link">对象 Object</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="javascript-对象属性的操作"><a href="#javascript-对象属性的操作" aria-hidden="true" class="header-anchor">#</a> javascript 对象属性的操作</h1> <p>ECMA-262第五版在定义只有内部才用的特性的时候，描述了属性的各种特征。实现这些特征是给 javascript 引擎用的，因此人为增加了一些难度，比如属性都用两个方括号套起来。而这种属性类型在部分场景的事件中可以带来很大的便利性，比如vue里的数据绑定。能操作好属性，在设计上又多了一层想象空间。</p> <p>记得，数组、函数，都是对象，都有属性的各种特性。只是平时用不会对数组进项这样的操作罢了。proxy 的方法倒是给了函数一些想象力。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name <span class="token punctuation">:</span> <span class="token string">'Nichoias'</span><span class="token punctuation">,</span>
  age <span class="token punctuation">:</span> <span class="token number">27</span><span class="token punctuation">,</span>
  job <span class="token punctuation">:</span> <span class="token string">'Software Engineer'</span><span class="token punctuation">,</span>
  <span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>我们都知道，引用类型存储在内存的堆空间，如上 person 变量指向堆空间的某个地址。其中的 name 属性当做简单类型看待？no!no!no! 如果这样想，那就是把执行上下文的变量概念和引用类型存取的概念搞混了。对象属性的数据存取，更像是有个代理人在打理，就像redux里的reducer一样，内部定义了一套逻辑，只能接受特定的命令、不可以乱来。</p> <h2 id="属性类型"><a href="#属性类型" aria-hidden="true" class="header-anchor">#</a> 属性类型</h2> <p>分为数据属性和访问器属性</p> <ol><li><strong>数据属性</strong>，四个描述其特性的属性是：</li></ol> <ul><li><code>[[ Configurable ]]</code><br>
默认 <em>true</em>, 如果为false，则被冻住了，有三层意思：
<ol><li>不可 <em>delete</em> 删除</li> <li>不可修改属性特性（一旦设置为<em>false</em>,则属性值就改不了了，简直不可逆啊，冷冻属性利器啊）</li> <li>不能把属性值修改为访问器属性</li></ol></li> <li><code>[[ Enumerable ]]</code> 可否使用 <em>for...in...</em> 枚举</li> <li><code>[[ Writable ]]</code> 是否可修改</li> <li><code>[[ Value ]]</code> 真正的值</li></ul> <ol start="2"><li>访问器属性</li></ol> <ul><li><code>[[ Configurable ]]</code> 与上面类似，不过为<em>false</em>的第三点需要反过来，不能改为数据属性</li> <li><code>[[ Enumerable ]]</code> 与上面相同</li> <li><code>[[ Get ]]</code> 获取值</li> <li><code>[[ Set ]]</code> 设置值，可接受新值作为参数</li></ul> <p>要改变属性值，可以用 <em>Object.defineProperty()</em> 方法,这也是定义单一属性的方式，注意传参。使用了<em>Object</em>上方法，而不是原型链上的，说明不是自家人，而是亲戚家的，设计者确实没想让你方便地操作对象属性。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    configurable<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    enumerable<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    value<span class="token punctuation">:</span> <span class="token string">'wang'</span>
    
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">3</span>

  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">set</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">{</span>
      age <span class="token operator">=</span> v <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  obj<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">1</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>age<span class="token punctuation">)</span> <span class="token comment">// {name: &quot;wang&quot;} 2</span>


  Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token string">'__proto__'</span><span class="token punctuation">)</span>
  <span class="token comment">// {enumerable: false, configurable: true, get: ƒ, set: ƒ}</span>
  <span class="token comment">// 对象的 __proto__ 属性，是从 Object.prototype 上获取的，并且是访问器属性</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>为啥要分数据属性和访问器属性呢？<br>
从上面打印输出的结果可以窥探一二：数据属性是能打印出来的值，而访问器属性是隐藏的（就像__proto__一样）（就像一个，不，一对幽灵一样，能存能取但就是看不到它，存取逻辑有关联但不一样）
粗略理解为，一个实体属性，一个是幽灵属性，这两类。</p> <p>为什么都有 <em>configurable</em> 和 <em>enumerable</em> 属性？<br>
这个问题隐含的条件是同一个属性名，一般，我们不会定义一个属性一会是实体属性，一会又是幽灵属性。虽然属性有两种分类，但一个属性名，同一时间只有一个身份。</p> <h2 id="定义属性-读取属性"><a href="#定义属性-读取属性" aria-hidden="true" class="header-anchor">#</a> 定义属性&amp;读取属性</h2> <p>上述的<em>Object.defineProperty()<em>方法可以定义单一属性，批操作也是可以有的，那就是</em>Object.defineProperties()</em> 方式。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">var</span> book <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    _year<span class="token punctuation">:</span><span class="token punctuation">{</span>
      value<span class="token punctuation">:</span> <span class="token number">2004</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    edition<span class="token punctuation">:</span><span class="token punctuation">{</span>
      value<span class="token punctuation">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    year<span class="token punctuation">:</span><span class="token punctuation">{</span>
      <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_year
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      
      <span class="token keyword">set</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>newValue <span class="token operator">&gt;</span> <span class="token number">2004</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>_year <span class="token operator">=</span> newValue
          <span class="token keyword">this</span><span class="token punctuation">.</span>edition<span class="token operator">=</span> newValue <span class="token operator">-</span> <span class="token number">2004</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>看着这个例子，是不是有点像闭包的功能了。<em>_year</em>变量理解为内部变量（虽然外部能访问到,但不可变writable=false，不可遍历枚举enumeable=false,冻住了configurable=false），存取<em>year</em>值都是对此值的操作。<em>year</em>同时也像代理人的意思。</p> <p>读取属性，使用 <em>Object.getOwnPropertyDescriptor()</em> 方法。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token comment">// 读取上例的book</span>
  <span class="token keyword">var</span> descriptor <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> <span class="token string">'_year'</span><span class="token punctuation">)</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>descriptor<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">// 2004</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>descriptor<span class="token punctuation">.</span>configurable<span class="token punctuation">)</span>  <span class="token comment">// false</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> descriptor<span class="token punctuation">.</span>get<span class="token punctuation">)</span>  <span class="token comment">// undefined</span>

  <span class="token keyword">var</span> descriptor <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> <span class="token string">'year'</span><span class="token punctuation">)</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>descriptor<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>descriptor<span class="token punctuation">.</span>configurable<span class="token punctuation">)</span>  <span class="token comment">// false</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> descriptor<span class="token punctuation">.</span>get<span class="token punctuation">)</span>  <span class="token comment">// function</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="proxy"><a href="#proxy" aria-hidden="true" class="header-anchor">#</a> Proxy</h2> <p><em>Proxy</em> 翻译过来就是代理，但是代理什么呢？既然是用在对象上，是不是首先想到的是<em>get</em>/<em>set</em>,然后没有了。<br>
多留些时间琢磨下，还有什么能代理的？可以先想想什么是对象。<br>
JS中，除了散列键值对组成的集合，数组、函数也都是对象，Date也是一类原生实现了的对象。</p> <p>虽然之前的ES规范里有访问器属性，可以使用 <em>set</em> <em>get</em> 自定义操作，也可称之为起了代理作用，但范围也就在某个属性上。如果让你设计一个功能强大、通用的代理对象的机制，该怎么做？</p> <p>捋一捋对象有哪些操作，哪些特征？</p> <ol><li>存取值，使用 <em>.</em> 操作符 或 <em>[ ]</em> 来获取 <em>get</em> <em>set</em></li> <li>继承关系，相关操作 <em>instanceof</em> <em>__proto__</em></li> <li>遍历操作 <em>for...in...</em></li> <li>判断key是否存在 <em>in</em></li> <li>数据属性和访问器属性操作 <em>Object.defineProperty</em> <em>Object.defineProperties</em></li> <li>函数的话，调用执行操作</li> <li>构造函数的话，<em>new</em> 操作</li> <li>调用方法时 <em>this</em> 指向问题<br>
...</li></ol> <p>既然要设计代理，不妨把这些特性一网打尽。之前的访问器属性还是太小气，一次只能设置一个属性。我们大方点，设计匹配通用属性的方式，就不能把<em>key</em>作为参数。<br>
考虑下返回值，代理后的对象是什么？在原值上操作？肯定不行，违反设计原则，最好来个分身，也就是一个新的对象。就好像你别墅里的管家一样，管家按照你的授权，帮你完成和社会的必要交流。关键是授权，哪些事情管家自己做，哪些事情依然落到你身上。
你可以有多个管家，创建的过程使用构造函数再合适不过了。</p> <h3 id="值的存取-set-get"><a href="#值的存取-set-get" aria-hidden="true" class="header-anchor">#</a> 值的存取 set get</h3> <p>于是这样如何：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">const</span> yourSelf <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'Li Lei'</span><span class="token punctuation">}</span>
  <span class="token keyword">const</span> agentConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> order<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> host<span class="token punctuation">[</span>order<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">set</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> order<span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">{</span>
      host<span class="token punctuation">[</span>order<span class="token punctuation">]</span> <span class="token operator">=</span> val
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> agent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>yourSelf<span class="token punctuation">,</span> agentConfig<span class="token punctuation">)</span> <span class="token comment">// target是要代理的对象 </span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>agent<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// Li Lei</span>
  agent<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Xiao hong&quot;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>agent<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// Xiao hong</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>agent<span class="token punctuation">.</span>age<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>既然是原生的构造函数，<em>Proxy</em>想当然应该是继承自 <em>Object</em></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Proxy</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Proxy <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>age<span class="token punctuation">.</span>__proto__ <span class="token operator">==</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><em>Proxy.prototype</em> 值竟然是 <em>undefined</em>,😯！！！看来得单独一篇写继承问题了</p> <p>专业一点，把 <em>order</em> 叫做 <em>propKey</em> ,把 <em>agentConfig</em> 叫做 <em>handler</em></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">const</span> book <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'红宝书'</span><span class="token punctuation">}</span>
  <span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> propKey<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> target<span class="token punctuation">[</span>propKey<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>标准里，<em>set</em> <em>get</em> 还有最后一个参数 <em>receiver</em> ,指代实例本身。实例也是对象，这个参数就是个指向堆空间的一个地址。我想在制造 <em>循环引用</em> <em>递归</em> 方面有用处。</p> <p>劫持了 <em>get</em> <em>set</em> 来做什么呢，说个应用，比如让 <em>get</em> 返回一个函数的场景：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">var</span> dom <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> propKey<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">attrs <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">...</span>children</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> ele <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>propKey<span class="token punctuation">)</span>
        Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>attrs<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">attrName</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
          ele<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span>attrName<span class="token punctuation">,</span> attrs<span class="token punctuation">[</span>attrName<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> child <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">var</span> text <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span>
            ele<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            ele<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span>
          <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> ele
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> fragment <span class="token operator">=</span> dom<span class="token punctuation">.</span><span class="token function">div</span><span class="token punctuation">(</span>
      <span class="token punctuation">{</span>id<span class="token punctuation">:</span><span class="token string">'container'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">'这里是container'</span><span class="token punctuation">,</span>
      dom<span class="token punctuation">.</span><span class="token function">ul</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        dom<span class="token punctuation">.</span><span class="token function">li</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token keyword">class</span><span class="token punctuation">:</span><span class="token string">'li'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'li1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        dom<span class="token punctuation">.</span><span class="token function">li</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token keyword">class</span><span class="token punctuation">:</span><span class="token string">'li'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'li2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        dom<span class="token punctuation">.</span><span class="token function">li</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token keyword">class</span><span class="token punctuation">:</span><span class="token string">'li'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'li3'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fragment<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>这样创建出来的树状结构的 DOM 节点，简单明了，核心是用了 <em>Proxy</em> 劫持任意属性，并返回任意格式数据（这里返回一个创建DOM的函数）</p> <p>再举例，一个链式操作：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">var</span> <span class="token function-variable function">pipe</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> quene <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token keyword">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> propKey<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>propKey <span class="token operator">!==</span> <span class="token string">'get'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          quene<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>window<span class="token punctuation">[</span>propKey<span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span> receiver
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
          <span class="token keyword">return</span> quene<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">cur</span><span class="token punctuation">(</span>acc<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

      <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> <span class="token function-variable function">double</span> <span class="token operator">=</span> <span class="token parameter">n</span> <span class="token operator">=&gt;</span> n <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">pow</span> <span class="token operator">=</span> <span class="token parameter">n</span> <span class="token operator">=&gt;</span> n <span class="token operator">*</span> n<span class="token punctuation">;</span>
  <span class="token function">pipe</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>double<span class="token punctuation">.</span>pow<span class="token punctuation">.</span>get<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>核心呢，使用了<em>闭包</em>、return <em>receiver</em> 、任意属性劫持 实现链式操作，挺巧妙的方式，看到这里是不是联想到科里化的模式。</p> <p>在 <em>get</em> <em>set</em> 时候，也不是任意属性都能劫持成功，如果一个属性是不可 <em>configurable</em> 且 不可 <em>writeable</em> 的，就会失败。没办法，他两具有绝对的优先判断权。</p> <p>对于 <em>set</em> 的劫持可以做一些什么事情呢？能想象到的场景有</p> <ol><li>可以封装值的复杂校验</li> <li>可以真正做到属性保护，因为属性是作为参数传递过来的，逻辑可以自定义</li></ol> <p>例子就不举了。</p> <h3 id="函数劫持-apply"><a href="#函数劫持-apply" aria-hidden="true" class="header-anchor">#</a> 函数劫持 apply</h3> <p>劫持函数到底能达到一个什么效果呢？传入一个函数，经过代理后，加上自定义逻辑，返回一个新的函数。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> args<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token function">target</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">}</span>
  <span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>add<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
  <span class="token function">proxy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// 3</span>
  <span class="token function">proxy</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// 5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>函数的执行，有一个上下文对象的概念，相当于一个对函数的一个扩展吧，可以在执行过程中从上下文对象里拿到丰富的api。单纯地函数执行该是多么地单调，而如果直接拿变量名称又显得耦合性太强，于是有了上下文对象的隐式调用，很巧妙的方式呐。<em>apply</em> 的第二个参数，专门就给这上下文留下的。第三个参数用来接收传来的参数。</p> <p>还是相当于给函数做了一层代理，实际用处暂且没想到好的场景。</p> <h3 id="属性存在与否-has"><a href="#属性存在与否-has" aria-hidden="true" class="header-anchor">#</a> 属性存在与否 has</h3> <p><em>has</em> 是判断属性是否存在，对应的操作符是 <em>in</em> 。容易和枚举搞混，对应的是 <em>for...in...</em> 。 此 <em>in</em> 非彼 <em>in</em> 。<br>
访问代理对象，或者其原型链上的属性，都会走<em>has</em>。<br>
如果使用了 <em>Object.preventExtensions</em> 来锁住对象，此时再用 <em>has</em> 返回 <em>false</em> 就会报错。对象被锁住，属性不可配置，代理就不能隐藏该属性。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">const</span> book <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span><span class="token string">'红宝书'</span><span class="token punctuation">,</span>
    _edition<span class="token punctuation">:</span> <span class="token number">4</span>
  <span class="token punctuation">}</span>
  Object<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> <span class="token punctuation">{</span>publisher<span class="token punctuation">:</span><span class="token string">&quot;人教出版社&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">has</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> propKey</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'propKey--'</span><span class="token punctuation">,</span> propKey<span class="token punctuation">)</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>propKey<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'_'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'name'</span> <span class="token keyword">in</span> proxy<span class="token punctuation">)</span> <span class="token comment">// true</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'_edition'</span> <span class="token keyword">in</span> proxy<span class="token punctuation">)</span> <span class="token comment">// false</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'publisher'</span> <span class="token keyword">in</span> proxy<span class="token punctuation">)</span> <span class="token comment">// false</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> proxy<span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token comment">// name _edition</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="构造函数的拦截-construct"><a href="#构造函数的拦截-construct" aria-hidden="true" class="header-anchor">#</a> 构造函数的拦截 construct</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">var</span> <span class="token function-variable function">Book</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">construct</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> args<span class="token punctuation">,</span> newTarget</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">target</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> Cons <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>Book<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
  <span class="token keyword">var</span> book <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cons</span><span class="token punctuation">(</span><span class="token string">'绿皮书'</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> book <span class="token keyword">instanceof</span> <span class="token class-name">Cons</span><span class="token punctuation">,</span> book <span class="token keyword">instanceof</span> <span class="token class-name">Book</span><span class="token punctuation">)</span> <span class="token comment">// Book {name: &quot;绿皮书&quot;} true true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>使用 <em>construct</em> （翻译：建造）函数来劫持，参数有 原构造函数、传入参数、以及和<em>get</em> <em>set</em> 相同的实例对象本身。也就是相当于原型链上加了个父对象。</p> <h3 id="删除的拦截-deleteproperty"><a href="#删除的拦截-deleteproperty" aria-hidden="true" class="header-anchor">#</a> 删除的拦截 deleteProperty</h3> <p>对象属性可以删除，使用 <em>delete</em> 操作符。如果设置了 <em>configurable</em> 为 <em>false</em> 则会报错。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">deleteProperty</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'_'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">invalid attempt to delete private </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> property</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">delete</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="定义属性操作的拦截-defineproperty"><a href="#定义属性操作的拦截-defineproperty" aria-hidden="true" class="header-anchor">#</a> 定义属性操作的拦截 defineProperty</h3> <p>虽然之前定义属性的方法是 <em>Object.defineProperty()</em> ，在<em>Object</em>原型上，看似关系远了。但是谁让你要操作、改变对象呢，作为功能全面的代理就有义务拦截下来。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> book <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'红宝书'</span><span class="token punctuation">}</span>
  <span class="token keyword">var</span> copyBook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>copyBook<span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> <span class="token string">'蝴蝶书'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  copyBook<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token string">'foo'</span> <span class="token comment">// 不生效</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="获取属性描述符的拦截-getownpropertydescriptor"><a href="#获取属性描述符的拦截-getownpropertydescriptor" aria-hidden="true" class="header-anchor">#</a> 获取属性描述符的拦截 getOwnPropertyDescriptor</h3> <p><em>Object.getOwnPropertyDescriptor(target, key)</em> 可获取属性的描述符，对此做拦截。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> book <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'红宝书'</span><span class="token punctuation">}</span>
  <span class="token keyword">var</span> copyBook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
  Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>copyBook<span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="获取原型对象的劫持-getprototypeof"><a href="#获取原型对象的劫持-getprototypeof" aria-hidden="true" class="header-anchor">#</a> 获取原型对象的劫持 getPrototypeOf</h3> <p>获取原型对象，对应一些操作符或方法或属性。</p> <ul><li>Object.prototype.__proto__ （__proto__ 是个访问器属性）</li> <li>Object.getPrototypeOf()</li> <li>Object.isPrototypeOf()</li> <li>instanceof</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">var</span> proto <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'人教'</span><span class="token punctuation">}</span>
  <span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">getPrototypeOf</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> proto
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> book <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">var</span> copyBook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
  Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>copyBook<span class="token punctuation">)</span> <span class="token operator">===</span> proto <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="对象扩展判断的拦截-isextensible"><a href="#对象扩展判断的拦截-isextensible" aria-hidden="true" class="header-anchor">#</a> 对象扩展判断的拦截 isExtensible</h3> <p><em>Object.isExtensible</em> 定义当前是否可以扩展，对此进行拦截。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">var</span> ins <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">isExtensible</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'in'</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  Object<span class="token punctuation">.</span><span class="token function">isExtensible</span><span class="token punctuation">(</span>ins<span class="token punctuation">)</span> <span class="token comment">// in</span>
  <span class="token comment">// Object.freeze(ins)</span>
  <span class="token comment">// Object.seal(ins)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>返回值是 <em>boolean</em> 类型。这里有个限制，就是必须和源对象的 <em>isExtensible</em> 返回值一致。代理的功能在这里打了折扣。不然会报错。</p> <h3 id="自身所有属性读取-ownkeys"><a href="#自身所有属性读取-ownkeys" aria-hidden="true" class="header-anchor">#</a> 自身所有属性读取 ownKeys</h3> <p>拦截对象自身属性读取，具体来首，拦截一下操作：</p> <ul><li>Object.getOwnPropertyNames()</li> <li>Object.getOwnPropertySymbols()</li> <li>Object.keys()</li> <li>for...in...</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">var</span> target <span class="token operator">=</span> <span class="token punctuation">{</span>
    a<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    b<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">'secret'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token string">'defi'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    enumerable<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    value<span class="token punctuation">:</span> <span class="token string">'static'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">ownKeys</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">'secret'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'defi'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>handler<span class="token punctuation">)</span>
  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span> <span class="token comment">// ['a']</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>对于自身属性的读取的拦截，也不是随意的，非原对象上的属性就会被过滤，同时 Symbol 值 以及不可遍历的属性，都会被自动过滤。<br>
另外，如果对象是被置为不可扩展的，返回了多余的值，则会报错。</p> <h3 id="阻止属性扩展的拦截-preventextensions"><a href="#阻止属性扩展的拦截-preventextensions" aria-hidden="true" class="header-anchor">#</a> 阻止属性扩展的拦截 preventExtensions</h3> <p>想要阻止扩展，首先就得是一个可扩展的 <em>Object.isExtensible</em> 为 <em>true</em> 。代理这个属性，返回值是 <em>boolean</em> ,语意上还得过得去，比如源对象本来是不可扩展的，代理后变成可以扩展的，那就会报错。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">preventExtensions</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment">// do somethings </span>
    Object<span class="token punctuation">.</span><span class="token function">preventExtensions</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
Object<span class="token punctuation">.</span><span class="token function">preventExtensions</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>需要在函数内实现真实的 <em>Object.preventExtensions(target)</em> 并且 <em>return true</em>，这样才不会报错。</p> <h3 id="设置原型对象的拦截-setpropertyof"><a href="#设置原型对象的拦截-setpropertyof" aria-hidden="true" class="header-anchor">#</a> 设置原型对象的拦截  setPropertyOf</h3> <p>如果对象不可扩展，则改变不了原型。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">setPrototypeOf</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> proto</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">// do somethins</span>
      Object<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> proto<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> book <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
  Object<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'红宝书'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="一个可取消的实例-proxy-revocable"><a href="#一个可取消的实例-proxy-revocable" aria-hidden="true" class="header-anchor">#</a> 一个可取消的实例 Proxy.revocable</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">var</span> target <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">let</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">let</span> <span class="token punctuation">{</span>proxy<span class="token punctuation">,</span> revoke<span class="token punctuation">}</span> <span class="token operator">=</span> Proxy<span class="token punctuation">.</span><span class="token function">revocable</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

  proxy<span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token number">1</span>
  proxy<span class="token punctuation">.</span>foo <span class="token comment">// 1</span>
  <span class="token function">revoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  proxy<span class="token punctuation">.</span>foo   <span class="token comment">// TypeError: Revoked</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>被 <em>revoke</em> 的实例，不能访问属性。场景可以是单次访问有效。</p> <h3 id="this-问题"><a href="#this-问题" aria-hidden="true" class="header-anchor">#</a> this 问题</h3> <p>Proxy 代理函数内的 <em>this</em> 是实例（<em>proxy</em>）本身，可能在 <em>target</em> 执行的过程中，会需要 <em>this</em> 绑定到当前对象上，需要改变 <em>this</em>。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">var</span> target <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">'2020-01-02'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> propKey<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>propKey <span class="token operator">===</span> <span class="token string">'getDate'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> target<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> propKey<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="一个使用代理简化请求的例子"><a href="#一个使用代理简化请求的例子" aria-hidden="true" class="header-anchor">#</a> 一个使用代理简化请求的例子</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">function</span> <span class="token function">createServer</span><span class="token punctuation">(</span><span class="token parameter">baseUrl</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token keyword">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> prop<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token function">fetch</span><span class="token punctuation">(</span>baseUrl <span class="token operator">+</span> prop<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> request <span class="token operator">=</span> <span class="token function">createServer</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8080/'</span><span class="token punctuation">)</span>
  request<span class="token punctuation">.</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>参考：</p> <ol><li><a href="https://book.douban.com/subject/1869705/" target="_blank" rel="noopener noreferrer">JavaScript 高级程序设计<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://es6.ruanyifeng.com/#docs/proxy" target="_blank" rel="noopener noreferrer">ECMAScript 6 入门<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/tech/js语言特性/基本数据类型.html">JS 的语法和数据类型</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/tech/assets/js/app.58c83021.js" defer></script><script src="/tech/assets/js/2.1d376163.js" defer></script><script src="/tech/assets/js/30.8332afa5.js" defer></script>
  </body>
</html>
